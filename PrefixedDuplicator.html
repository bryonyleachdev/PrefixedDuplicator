<!DOCTYPE html>
<html>
<head>
  <title>PrefixedDuplicator</title>
</head>
<body>
<h4>PrefixedDuplicator</h4>
<textarea id="input" rows="6" cols="30" placeholder="Type or paste lines here"></textarea>
<br>
<input id="prefixes" type="text" placeholder="Prefix(es)">
<br>
Eg. group-hover:,hover:,dark:,dark:group-hover:,dark:hover:
<br>
<label>
  <input type="checkbox" id="includeOriginal"> Include original text
</label>
<br>
<label>
  <input type="radio" name="mode" value="intermingled"> Intermingled
</label>
<label>
  <input type="radio" name="mode" value="batched" checked> Batched Results
</label>
<br><br>
<button onclick="processLines()">Duplicate with Prefixes</button>
<button id="copyBtn" onclick="copyOutput()" style="display:none;">Copy</button>
<pre id="output"></pre>

<script>
function processLines() {
  const prefixes = document.getElementById("prefixes").value
                    .split(",")
                    .map(p => p.trim())
                    .filter(p => p.length > 0);

  const inputText = document.getElementById("input").value.trim();
  const lines = inputText.split("\n");
  const includeOriginal = document.getElementById("includeOriginal").checked;
  const mode = document.querySelector('input[name="mode"]:checked').value;

  let result = [];

  if (mode === "intermingled") {
    result = lines.flatMap(line => {
      const clean = line.trim();
      const withoutQuote = clean.substring(1); // remove leading "
      const prefixed = prefixes.map(prefix => `"${prefix}${withoutQuote}`);
      return includeOriginal ? [clean, ...prefixed] : prefixed;
    });
  } else if (mode === "batched") {
    if (includeOriginal) {
      result.push(...lines.map(line => line.trim()));
    }
    prefixes.forEach(prefix => {
      result.push(...lines.map(line => {
        const clean = line.trim();
        const withoutQuote = clean.substring(1);
        return `"${prefix}${withoutQuote}`;
      }));
    });
  }

  const outputEl = document.getElementById("output");
  const copyBtn = document.getElementById("copyBtn");
  outputEl.innerText = result.join("\n");

  if (result.length > 0) {
    copyBtn.style.display = "inline-block";
    copyBtn.innerText = "Copy"; // reset button text when new output is generated
  } else {
    copyBtn.style.display = "none";
  }
}

function copyOutput() {
  const output = document.getElementById("output").innerText;
  navigator.clipboard.writeText(output).then(() => {
    const copyBtn = document.getElementById("copyBtn");
    copyBtn.innerText = "Copied!";
  });
}
</script>
</body>
</html>
